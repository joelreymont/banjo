---
title: Fix vim.t copy issue - use module-level state indexed by tabpage
status: closed
priority: 2
issue-type: task
created-at: "2026-01-06T06:31:22.120629+02:00"
closed-at: "2026-01-06T06:34:00.857984+02:00"
---

File: nvim/lua/banjo/panel.lua - vim.t creates copies on access, so state.field = value doesn't persist. Replace with: local states = {} indexed by vim.api.nvim_get_current_tabpage(). Change get_state() to: local tabid = vim.api.nvim_get_current_tabpage(); if not states[tabid] then states[tabid] = {...}; return states[tabid]. No set_state() needed.
